# Audio Libraries

オーディオを扱うライブラリ、フレームワーク、ミドルウェアについて。

## Audio I/O

マルチプラットフォームに使用できるライブラリとして *JUCE*, *PortAudio*, *libsoundio* 等が存在する。どれも長所と短所があり、一概にこれと言える決定解は無い。

### JUCE

流石に完成度が高い。しかし商用利用に制限がある（OSS ではあるが permissive なライセンスではない）。小規模なプラグインの開発に用いるには、やや大掛かり過ぎるきらいもある。本格的なアプリケーション開発においてのみ候補となりうるものとして考えるべきか。

### PortAudio

オープンソースでマルチプラットフォームなライブラリとしては最も有名なものの一つ。完成度はそれなりに高いが、設計にやや野暮ったさを感じる。Android 非対応。

### libsoundio

直行性の高い API 設計、C 言語オンリーでの実装、等々、小規模なプラグインやユーティリティの開発には魅力的なライブラリ。ただし、開発が活発ではなく、不具合も多数存在するなど、欠点も多い。Android 非対応。

### どれを使うべきか

当初は PortAudio を使用していたが、後発で登場した libsoundio に魅力を感じたため、これに以降した。しかし、結果にはあまり満足していない。将来的に大きく改善される見込みも無いので、再び他の候補を探すか、思い切って PortAudio に戻すべきかもしれない。

これら以外の新たなライブラリが登場することにも期待したい。数年おきにトレンドを再確認していく必要があるだろう。

## libsoundio の問題点

### チャンネルレイアウト問題

libsoundio は入出力に適切なチャンネルレイアウトが存在することを前提としている。これは多チャンネル I/O において問題を生じる可能性がある。

具体例として、macOS に MC-101 を接続した場合の問題を挙げる。 MC-101 はホストに対する入力としてステレオ５トラック（計 10 チャンネル）を定義しているが、このチャンネルレイアウトがステレオであることから、libsoundio は 2 チャンネルしか存在しないものとして誤認識してしまう。これは、チャンネルレイアウトからチャンネル数を断定できるとしてしまっている libsoundio 側の問題である。

Unity プラグイン用の fork では、この問題に対するワークアラウンドを施してある。下記 commit を参照のこと。

https://github.com/keijiro/libsoundio/commit/db72d17218029eb2aba59f392f89a3a134ae1b4c
