# SquareWheeler

![GIF](https://github.com/user-attachments/assets/b8d94661-1822-4f3f-94e1-902ad67a127b)

- https://unityroom.com/games/square-wheeler
- https://github.com/keijiro/SquareWheeler

unity1week で開発したプロジェクト。久しぶりにゲームとして遊べる完成状態のサンプルを作成したかも。

## 開発の過程

- 短期間で遊べるものを作るなら、いわゆる「クソ物理ゲー」しかない、という考えがあり、それでいてテーマ「ない」に沿ったものにするなら何になるだろうか……という逆算で制作した。
- アイデア段階ではタイムアタック式のレースゲームを考えていたが、プロトタイピングを行った結果、これは infinite runner の方が上手くまとまりそうだな、と感じ、方向転換した。
- 自機の物理シムについては、試しに Hinge Joint で組んでみたところ、一発で機能したので、それをそのまま最終形として採用した。
- 障害物を配置するシステムなどもプロトタイピングの時点でほぼ固まっていた。
- １日目のプロトタイピングの時点でゲームのコアとなる部分はほぼ全て検証が済んだので、あとは気楽だった。
  - Getting Over It 的な「檄ムズゲー」のテイストは、このプロトタイピングの時点で固まった。
  - 難易度曲線を上手く設計できるかどうかだけが不安要素だった。
- 残りの時間は、見た目の向上や UI や音の追加など、周辺要素にほぼ費やされた。
- 今後も unity1week に参加するなら、同じようなペース配分をイメージする必要があるだろうと思った。

## 使用した機能

比較的新めの機能を積極的に採用した。

- URP & Render Graph をベースとした。
  - KinoEight エフェクトはこのために URP 対応と Render Graph 対応を行った。
  - ただし特に URP & Render Graph の新機能を活用したというわけではない。そこが若干寂しいところ。
- Unity Web
  - 以前と比較してバイナリサイズはだいぶ縮まっているように思えた。
    - しかし URP 採用による増加でほぼ相殺されているか？
  - WebGPU も使いたかったが、iPhone で気軽に遊べる状態にしたかったので、我慢して WebGL ベースとした。
- UI は UI Toolkit で構築している。
  - これは本当に使いやすいという感想しかない。
  - ただし、後述するが、最適化についてはあまり考える余裕が無かった。
- 入力の処理は (New) Input System のみを使用している。
  - この程度のシステムだと使用感はさほど変わらないが、ほんのちょっと便利なところがある。
- 以前なら Coroutine で組んでいた部分は、ほぼ Awaitable になった。
- WebGL 対応のため残念ながら VFX Graph 使用は断念。久しぶりに Shuriken を使用した。

## 意図的な手抜き

意図的に手を抜いている部分がかなりある。

- 通り過ぎた地形を削除せずに放置してしまっている。原理的には、進めば進むほど負荷が高まる。
  - 今回の仕組みでは、この負荷が問題になるほど長くは生き残れないだろう……という打算的な設計。
- 自機及びカメラシステムを巨大な単一 prefab に突っ込んでいる。
  - 自機復活時の処理がだいぶ簡略化できた（インスタンスを丸ごと削除して再生成するだけでよい）
  - しかし、リスタートの度に重いインスタンス化処理が動いていることになる。ちゃんとしたプロダクトでは避けるべきプラクティス。
- UI Toolkit のアニメーション処理の最適化を行なっていない。
  - Hint の設定を行うべき。
  - Class のトグルでアニメーションを行なっている部分があるが、これは本来あまり推奨されない。
    - しかしこれが最も手軽な方法であるということもよく分かった。UI デザイナーさんは、当然これを使いたがるだろう……
  - UI を非表示にする処理も、Visible の操作で実現するか、Color の Alpha で実現するか、本当はよく吟味して選択するべき。
    - しかしこれも急いでいたら吟味するの面倒だな、というのがよく分かった。
